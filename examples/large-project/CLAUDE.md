# LargeProject — Навигация для Claude

> **Философия:** `.claude/project.skills.md`
> **Глобальные правила:** `~/.claude/global.skills.md`

---

## Роутинг задач (СМОТРИ СЮДА ПЕРВЫМ)

| Тип задачи | Куда идти | Строки/Детали |
|------------|-----------|---------------|
| **Бизнес-логика** | `src/lib/actions.ts` | :258 sendMessage, :312 runAgent |
| **Telegram бот** | `src/bot/handler.py` | :150 cmd_start, :280 callback_menu |
| **Кредиты** | `src/lib/credits.ts` | :19 checkCredits |
| **БД схема** | `prisma/schema.prisma` | — |
| **Auth** | `src/lib/auth.ts` | 50 строк, маленький |

---

## Индекс actions.ts (804 строки)

**Структура:**
- :1-50 — Импорты, типы
- :50-300 — AI функции
- :300-600 — CRUD операции
- :600+ — Утилиты

| Функция | Строка | Назначение |
|---------|--------|------------|
| `sendMessage` | 258 | AI чат — отправка |
| `runAgent` | 312 | **Главная** — запуск агента |
| `createItem` | 420 | Создание записи |
| `deleteItem` | 485 | Удаление |
| `moveItem` | 520 | Перемещение |

---

## Индекс handler.py (1200 строк)

**Структура:**
- :1-100 — Импорты, конфиг
- :100-500 — Команды (/start, /help)
- :500-900 — Callbacks
- :900+ — Утилиты

| Функция | Строка | Назначение |
|---------|--------|------------|
| `cmd_start` | 150 | /start — точка входа |
| `cmd_help` | 210 | /help |
| `callback_menu` | 280 | Главное меню |
| `callback_settings` | 450 | Настройки |
| `send_notification` | 920 | Утилита уведомлений |

---

## Ключевые файлы (с размерами)

```
src/lib/                           # Бизнес-логика
├── actions.ts       (804)         # БОЛЬШОЙ — используй индекс
├── credits.ts       (223)         # Кредиты
├── auth.ts          (50)          # Auth — маленький
└── utils.ts         (30)          # Утилиты — маленький

src/bot/                           # Telegram бот
├── handler.py       (1200)        # ОГРОМНЫЙ — используй индекс
└── keyboards.py     (80)          # Клавиатуры

src/components/                    # UI
├── Dashboard.tsx    (350)         # Дашборд
└── Settings.tsx     (120)         # Настройки
```

---

## Prisma модели

| Модель | Назначение |
|--------|------------|
| `User` | Пользователи |
| `Item` | Основные записи |
| `Credit` | Баланс кредитов |

---

## Env переменные

```env
DATABASE_URL          # PostgreSQL
OPENAI_API_KEY        # AI
BOT_TOKEN             # Telegram
CLERK_*               # Auth
```

---

## НЕ ТРАТЬ ТОКЕНЫ

1. **actions.ts** — 804 строки, используй индекс выше
2. **handler.py** — 1200 строк, используй индекс выше
3. **Маленькие файлы** (<100) — можно читать целиком

---

*Обновлено: 2024-01-15*
