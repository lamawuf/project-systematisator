# Методология Project Systematisator

> Подробное руководство для AI-ассистентов (Claude Code, Cursor, Copilot).

---

## Часть 1: Идея и философия

### Проблема

Когда работаешь с AI-ассистентом над реальным проектом, возникает проблема:

**AI тратит кучу токенов на разведку.**

Каждый раз когда ты просишь что-то сделать, AI:
1. Читает файлы целиком (даже если нужна одна функция)
2. Ищет по всему проекту (grep, find)
3. Пытается понять структуру с нуля
4. Не знает где что лежит

В результате:
- **Медленно** — много времени на "понимание контекста"
- **Дорого** — токены тратятся на чтение, а не на работу
- **Неточно** — AI может пропустить важное или читать не то

### Решение

**Создать "карту проекта" для AI** — структурированную документацию, которая:
- Говорит куда идти для каждого типа задачи
- Индексирует большие файлы по функциям и строкам
- Экономит токены в 10-20 раз

### Аналогия

Представь что ты новый разработчик в команде:
- **Без онбординга:** Бродишь по коду, читаешь всё подряд, спрашиваешь коллег
- **С онбордингом:** Тебе дают карту проекта, показывают где что, объясняют архитектуру

Project Systematisator — это **онбординг для AI**.

---

## Часть 2: Экономия токенов

### До оптимизации

```
Задача: "поправь логику кредитов"

AI делает:
1. grep -r "credit" .           → 500 токенов
2. cat actions.ts               → 800 строк = 3000 токенов
3. cat credits.ts               → 223 строки = 900 токенов
4. Ещё пара файлов              → 1000 токенов
─────────────────────────────────────────────────
Итого на разведку:              ~5400 токенов
```

### После оптимизации

```
Задача: "поправь логику кредитов"

AI делает:
1. Смотрит CLAUDE.md роутинг    → 100 токенов
2. Видит: credits.ts :19
3. Читает credits.ts:19-90      → 300 токенов
─────────────────────────────────────────────────
Итого на разведку:              ~400 токенов
```

**Экономия: 10-15x** на типичных задачах.

---

## Часть 3: Применение (алгоритм для Claude Code)

### Фаза 1: Разведка

```bash
# Структура
ls -la
find . -type f \( -name "*.py" -o -name "*.ts" \) \
  -not -path "*/node_modules/*" -not -path "*/venv/*"

# Размеры
wc -l **/*.py **/*.ts 2>/dev/null | sort -n

# Документация
ls -la *.md .claude/ docs/ 2>/dev/null
```

### Фаза 2: Индексация больших файлов (>200 строк)

```bash
# Python
grep -n "^def \|^async def \|^class " файл.py

# TypeScript
grep -n "^export\|^function" файл.ts
```

### Фаза 3: Создание структуры

```bash
mkdir -p .claude
```

Создать:
- `CLAUDE.md` — роутинг + индексы
- `.claude/project.skills.md` — философия
- `.claude/settings.local.json` — permissions

### Фаза 4: Очистка мусора

Удалить:
- .backup, .old, .copy файлы
- Пустые файлы
- Пароли/токены из settings.local.json

### Фаза 5: Валидация

Проверить:
- [ ] CLAUDE.md содержит роутинг
- [ ] Большие файлы проиндексированы
- [ ] Размеры указаны
- [ ] project.skills.md создан

---

## Часть 4: Правила индексации

| Размер файла | Действие |
|--------------|----------|
| <50 строк | "маленький, можно целиком" |
| 50-200 | Краткое описание |
| 200-500 | Индекс основных функций |
| 500+ | Полный индекс + структура |

### Формат индекса

```markdown
## Индекс {файл} ({строк} строк)

**Структура:** (для 500+)
- :1-100 — Импорты, константы
- :100-300 — Основная логика
- :300+ — Вспомогательные

| Функция | Строка | Назначение |
|---------|--------|------------|
| `main` | 15 | **Главная** — точка входа |
| `helper` | 50 | Вспомогательная |
```

---

## Часть 5: Шаблоны

### CLAUDE.md

```markdown
# {Project} — Навигация для Claude

> **Философия:** `.claude/project.skills.md`
> **Глобальные правила:** `~/.claude/global.skills.md`

## Роутинг задач (СМОТРИ СЮДА ПЕРВЫМ)
| Тип задачи | Куда идти | Строки |
...

## Индекс {big_file} ({N} строк)
...

## НЕ ТРАТЬ ТОКЕНЫ
1. {big_file} — {N} строк, используй индекс
```

### project.skills.md

```markdown
# {Project} — Project Skills

## Философия продукта
### Главная идея
...

## Специфика
### Стек
...

## Закиды из обсуждений
### {DATE}: ...
```

---

## Часть 6: Чеклист

### При входе в проект

- [ ] Есть CLAUDE.md?
- [ ] Индексы актуальны (номера строк)?
- [ ] Все файлы >200 проиндексированы?
- [ ] .claude/project.skills.md существует?
- [ ] Нет мусора в settings.local.json?

Если нет — запусти систематизацию.

### После рефакторинга

```bash
python scripts/update-index.py --all
```

Или вручную обнови номера строк в CLAUDE.md.

---

## Дополнительные бенефиты

### 1. Документирование на ходу

При обсуждении идей — записываем в `project.skills.md`:

```markdown
## Закиды из обсуждений

### 2024-01-15: Оптимизация навигации
- Создали трёхуровневую систему Skills
- Правило: записывать такие обсуждения
```

Контекст не теряется между сессиями.

### 2. Быстрый старт новых проектов

```bash
bash ~/project-systematisator/templates/init-project.sh "NewProject"
```

### 3. Чистота кода

Правило из global.skills.md:
> "Не срать всю разработку, чтобы потом убираться. Чистить по ходу."

AI следует этим правилам автоматически.

### 4. Единый стандарт

Все проекты структурированы одинаково:
- Знаешь где искать
- Легко переключаться между проектами
- Новые люди быстрее вникают

---

*Версия 2.0*
